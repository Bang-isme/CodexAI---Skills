# Pre-Deployment Penetration Testing Checklist

## Authentication & Authorization
- [ ] Login with valid credentials → succeeds
- [ ] Login with invalid credentials → fails with generic error
- [ ] Login rate limited (5 attempts per minute)
- [ ] Account lockout after 10 failed attempts
- [ ] Password reset token is single-use and expires in 1 hour
- [ ] JWT tokens expire in ≤ 15 minutes
- [ ] Refresh tokens can be revoked
- [ ] Admin routes return 403 for non-admin users
- [ ] User A cannot access User B's resources (IDOR test)

## Input Validation
- [ ] SQL injection: `' OR 1=1 --` in all text inputs
- [ ] NoSQL injection: `{"$gt":""}` in JSON body
- [ ] XSS: `<script>alert(1)</script>` in all text inputs
- [ ] Path traversal: `../../etc/passwd` in file path params
- [ ] Command injection: `; ls -la` in text inputs
- [ ] SSRF: `http://169.254.169.254/` in URL inputs
- [ ] Oversized payload (>1MB body) → rejected
- [ ] Malformed JSON → 400, not 500

## API Security
- [ ] All endpoints require authentication (except public)
- [ ] CORS headers restrict to specific origins
- [ ] Rate limiting on all endpoints
- [ ] Response doesn't include sensitive fields (password hash, internal IDs)
- [ ] Error responses don't include stack traces in production
- [ ] File upload validates MIME type + extension + size
- [ ] No debug endpoints accessible (/debug, /test, /phpinfo)

## Infrastructure
- [ ] HTTPS only (HTTP redirects to HTTPS)
- [ ] SSL Labs grade A or A+
- [ ] Security headers present (HSTS, CSP, X-Frame-Options)
- [ ] Database ports not accessible from internet
- [ ] No default credentials on any service
- [ ] Docker containers run as non-root
- [ ] Environment variables don't contain secrets in logs

## Data Protection
- [ ] Sensitive data encrypted at rest
- [ ] Backups encrypted and access-controlled
- [ ] Logs don't contain passwords, tokens, or PII
- [ ] File uploads stored outside web root
- [ ] Database queries use parameterized statements

## Monitoring
- [ ] Failed login attempts are logged
- [ ] Admin actions are logged
- [ ] Error rate alerting configured
- [ ] Unauthorized access attempts trigger alerts
