# Vulnerability Scanning

## Scanner Types

| Type | What It Scans | Tools | When |
| --- | --- | --- | --- |
| Network scanner | Open ports, services | Nmap, Masscan | Monthly |
| Web scanner | Web app vulnerabilities | OWASP ZAP, Nikto, Burp | Per release |
| Container scanner | Docker image CVEs | Trivy, Snyk, Scout | Every build (CI) |
| Dependency scanner | npm/pip package CVEs | npm audit, Snyk | Every build (CI) |
| Infrastructure scanner | Cloud misconfigs | ScoutSuite, Prowler | Weekly |
| Secret scanner | Leaked credentials | TruffleHog, git-secrets | Every commit |

## OWASP ZAP (Free Web Scanner)

```bash
# Quick scan (passive + active)
docker run -t ghcr.io/zaproxy/zaproxy:stable zap-baseline.py \
  -t https://target.com \
  -r report.html

# Full scan (active scanning — more aggressive)
docker run -t ghcr.io/zaproxy/zaproxy:stable zap-full-scan.py \
  -t https://target.com \
  -r full-report.html

# API scan (OpenAPI/Swagger)
docker run -t ghcr.io/zaproxy/zaproxy:stable zap-api-scan.py \
  -t https://target.com/api-docs.json \
  -f openapi \
  -r api-report.html
```

## Nmap Security Scanning

```bash
# Vulnerability scripts
nmap --script vuln target.com

# HTTP-specific vulnerabilities
nmap --script http-vuln-* -p 80,443 target.com

# SSL vulnerabilities
nmap --script ssl-* -p 443 target.com

# Brute force (authorized testing only)
nmap --script brute -p 22 target.com
```

## Dependency Scanning (npm)

```bash
# Built-in audit
npm audit
npm audit --audit-level=high   # Only show high + critical

# Fix automatically
npm audit fix

# Snyk (more comprehensive)
npx snyk test
npx snyk monitor   # continuous monitoring

# Output as JSON for CI processing
npm audit --json > audit-results.json
```

## Secret Scanning

```bash
# TruffleHog — scan git history for secrets
trufflehog git file://. --json --only-verified

# git-secrets — pre-commit hook
git secrets --install
git secrets --scan

# GitHub has built-in secret scanning for public repos
# Enable in: Settings → Code security → Secret scanning
```

## Cloud Infrastructure Scanning

```bash
# AWS — ScoutSuite
scout aws --report-dir ./scout-report

# AWS — Prowler (CIS benchmarks)
prowler aws --compliance cis_level1

# Terraform — tfsec (IaC misconfigs)
tfsec ./terraform/
```

## Scanning Schedule

| Scan Type | Frequency | Automated? |
| --- | --- | --- |
| Dependency audit | Every CI build | ✅ Yes |
| Container image scan | Every CI build | ✅ Yes |
| Secret scanning | Every commit | ✅ Yes (pre-commit) |
| Web app scan (ZAP baseline) | Per release | ✅ Yes (CI) |
| Web app full scan (ZAP active) | Monthly | Semi-auto |
| Network scan (Nmap) | Monthly | Semi-auto |
| Cloud config (Prowler) | Weekly | ✅ Yes |
| Penetration test (manual) | Quarterly | ❌ Manual |

## Severity Classification

| Severity | CVSS | Example | Response Time |
| --- | --- | --- | --- |
| Critical | 9.0-10.0 | RCE, SQL injection, auth bypass | < 24 hours |
| High | 7.0-8.9 | XSS stored, IDOR, privilege escalation | < 1 week |
| Medium | 4.0-6.9 | CSRF, information disclosure | < 1 month |
| Low | 0.1-3.9 | Missing headers, verbose errors | < 3 months |
| Info | 0.0 | Best practice recommendations | Backlog |
