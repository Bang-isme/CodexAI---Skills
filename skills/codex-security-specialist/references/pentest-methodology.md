# Penetration Testing Methodology

## Phases

```
1. RECON → 2. SCANNING → 3. ENUMERATION → 4. EXPLOITATION → 5. POST-EXPLOIT → 6. REPORTING
```

## Phase 1: Reconnaissance (Passive)

| Tool/Technique | Purpose | Command/URL |
| --- | --- | --- |
| WHOIS | Domain registration info | `whois example.com` |
| DNS Recon | Subdomains, records | `dig any example.com` |
| Subfinder | Subdomain enumeration | `subfinder -d example.com` |
| Shodan | Internet-exposed services | `shodan search hostname:example.com` |
| Google Dorks | Exposed files/configs | `site:example.com filetype:env` |
| Wayback Machine | Historical pages/endpoints | `web.archive.org` |
| Certificate Transparency | Find subdomains via certs | `crt.sh/?q=%.example.com` |
| GitHub Search | Leaked credentials/code | Search repo for API keys/passwords |

### Google Dork Examples
```
site:example.com filetype:sql           # Exposed DB dumps
site:example.com inurl:admin            # Admin panels
site:example.com "password" filetype:log # Leaked logs
site:example.com ext:env | ext:yml      # Config files
```

## Phase 2: Scanning (Active)

```bash
# Port scan — identify open ports/services
nmap -sV -sC -O -oN scan.txt target.com
# -sV: version detection, -sC: default scripts, -O: OS detection

# Quick scan (top 1000 ports)
nmap -T4 -F target.com

# Full port scan
nmap -p- -T4 target.com

# UDP scan (common ports)
nmap -sU --top-ports 50 target.com

# Web vulnerability scan
nikto -h https://target.com
```

## Phase 3: Enumeration

```bash
# Web directory brute force
gobuster dir -u https://target.com -w /usr/share/wordlists/dirb/common.txt

# API endpoint discovery
ffuf -u https://target.com/api/FUZZ -w api-endpoints.txt

# Technology fingerprinting
whatweb https://target.com
wappalyzer # (browser extension)
```

## Phase 4: Exploitation

### Web Application Tests
| Test | Tool | Target |
| --- | --- | --- |
| SQL Injection | sqlmap | Forms, URL params, headers |
| XSS | XSSStrike | Input fields, URL params |
| CSRF | Manual / Burp | State-changing forms |
| SSRF | Manual | URL inputs, webhooks |
| Auth bypass | Manual / Burp | Login, password reset |
| File upload | Manual | Upload endpoints |
| IDOR | Manual / Burp | API endpoints with IDs |

```bash
# SQLMap (automated SQL injection)
sqlmap -u "https://target.com/api/users?id=1" --dbs --batch

# WARNING: Only use on systems you have WRITTEN AUTHORIZATION to test
```

### API-Specific Tests
```
1. Test without auth token → should get 401
2. Test with expired token → should get 401
3. Test user A token on user B resources → should get 403/404
4. Test with manipulated JWT payload → should reject
5. Test rate limiting → should get 429 after threshold
6. Test oversized payloads → should reject (413)
7. Test SQL/NoSQL injection in all inputs
8. Test path traversal: /api/files/../../etc/passwd
```

## Phase 5: Post-Exploitation

```
- Document all findings with evidence (screenshots, logs)
- Assess impact (confidentiality, integrity, availability)
- Classify severity (Critical, High, Medium, Low, Info)
- DO NOT: modify data, install persistent backdoors, access beyond scope
```

## Phase 6: Report Template

```markdown
# Penetration Test Report

## Executive Summary
- Scope: [what was tested]
- Duration: [dates]
- Overall Risk: [Critical/High/Medium/Low]
- Key Findings: [count by severity]

## Findings

### [CRITICAL] SQL Injection in /api/users
- **URL**: POST /api/users?search=
- **Impact**: Full database read/write access
- **Evidence**: [screenshot/payload]
- **Remediation**: Use parameterized queries
- **CVSS Score**: 9.8

### [HIGH] Missing Rate Limiting on Login
- **URL**: POST /api/auth/login
- **Impact**: Brute force attack possible
- **Evidence**: 10,000 requests in 60 seconds accepted
- **Remediation**: Implement rate limiting (5 req/min)
```

## Legal & Ethics
- ⚠️ ALWAYS get written authorization before testing
- ⚠️ Stay within agreed scope
- ⚠️ Report vulnerabilities immediately, don't exploit for gain
- ⚠️ Protect any data accessed during testing
